# Дедубликация
'''
    CREATE TABLE product_cor AS SELECT product_id
                                      ,brand
                                      ,product_line
                                      ,product_class
                                      ,product_size
                                      ,list_price
                                      ,standard_cost
	FROM (
        SELECT *
              ,row_number() over(partition by product_id ORDER BY list_price desc) AS rn
        FROM product
    ) AS rm where rn = 1

''';

# Подключиться как пользователь postgres
$ sudo -u postgres psql

# Подключиться к БД из под любого существующего в БД пользователя
$ psql -h localhost -U user_name_here -d db_name_here

# Создать пользователя
postgres=# CREATE USER user_name_here WITH PASSWORD 'your_password_here';

# Удалить пользователя
postgres=# DROP USER user_name_here;
# или
postgres=# DROP ROLE user_name_here;
# или
postgres=# DROP DATABASE db_name_here DROP USER user_name_here; # если user владеет БД

# Создать БД
postgres=# CREATE DATABASE db_name_here WITH OWNER owner_user_name_here;

# Удалить БД
postgres=# DROP DATABASE db_name_here;

# Предоставить права пользователю
postgres=# GRANT ALL PRIVILEGES ON DATABASE db_name_here TO to_user_name_here;

# Посомотреть все БД
\l

# Посомотреть всех пользователей
\du

# Выйти из командной строки `psql`
\q
